<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>DRF Media Platform</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0fcf9;
    margin: 0;
    padding: 20px;
    text-align: center;
  }
  #container {
    max-width: 600px;
    margin: auto;
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  #walletAddress {
    font-weight: bold;
    margin-bottom: 15px;
    word-break: break-all;
  }
  #username {
    font-size: 1.2em;
    margin-bottom: 5px;
  }
  #logoutBtn {
    background: #0baf9a;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 15px;
  }
  #logoutBtn:hover {
    background: #087a73;
  }
  textarea {
    width: 100%;
    height: 80px;
    margin-top: 15px;
    resize: none;
    padding: 10px;
    font-size: 1em;
  }
  #postBtn {
    background: #0baf9a;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
  }
  #postBtn:hover {
    background: #087a73;
  }
  #posts {
    margin-top: 30px;
    text-align: left;
  }
  .post {
    background: #e6f5f1;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 6px;
    word-break: break-word;
  }
</style>
</head>
<body>
  <div id="container">
    <div id="username"></div>
    <div>Your DRFM Token Address:</div>
    <div id="walletAddress"></div>
    
    <textarea id="postContent" placeholder="What's on your mind?"></textarea>
    <br />
    <button id="postBtn">Post</button>
    <button id="logoutBtn">Logout</button>

    <div id="posts">
      <h3>Posts</h3>
      <!-- Posts will appear here -->
    </div>
  </div>

  <script>
    // Load user info
    const username = localStorage.getItem('drf_username');
    const walletAddress = localStorage.getItem('drf_active_wallet');

    if (!username || !walletAddress) {
      alert('No active session found. Redirecting to login.');
      window.location.href = 'media_login.html'; // Or your login page filename
    }

    document.getElementById('username').innerText = `Welcome, ${username}!`;
    document.getElementById('walletAddress').innerText = walletAddress;

    // Load posts from localStorage (simplified)
    let posts = JSON.parse(localStorage.getItem('drf_media_posts') || '[]');

    function renderPosts() {
      const postsDiv = document.getElementById('posts');
      postsDiv.innerHTML = '<h3>Posts</h3>';
      if(posts.length === 0) {
        postsDiv.innerHTML += '<p>No posts yet.</p>';
        return;
      }
      posts.slice().reverse().forEach(post => {
        const div = document.createElement('div');
        div.className = 'post';
        div.textContent = `${post.username} (${post.address}): ${post.content}`;
        postsDiv.appendChild(div);
      });
    }

    renderPosts();

    document.getElementById('postBtn').addEventListener('click', () => {
      const content = document.getElementById('postContent').value.trim();
      if (!content) return alert('Please write something before posting.');

      posts.push({
        username,
        address: walletAddress,
        content,
        timestamp: Date.now()
      });

      localStorage.setItem('drf_media_posts', JSON.stringify(posts));
      document.getElementById('postContent').value = '';
      renderPosts();
    });

    document.getElementById('logoutBtn').addEventListener('click', () => {
      localStorage.removeItem('drf_username');
      localStorage.removeItem('drf_active_wallet');
      localStorage.removeItem('drf_user_data');
      localStorage.removeItem('drf_encrypted_wallet');
      window.location.href = 'media_login.html'; // Your login page here
    });
  </script>
</body>
</html>
