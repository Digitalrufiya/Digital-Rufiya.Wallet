<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DRFMedia Timeline — Spread Kindness & Truth</title>
  <link rel="icon" href="https://drfmedia.com/favicon.ico" />
  <style>
    /* [Styles are same as your file, already clean and mobile-friendly] */
    /* To save space, I’ll not repeat them here since you already pasted full CSS */
  </style>
</head>
<body>

<header>
  <div class="navbar-left">
    <img src="https://drfmedia.com/favicon.ico" alt="DRFMedia Logo" />
    <h1>DRFMedia Timeline</h1>
  </div>
  <button id="menuToggle" aria-label="Toggle menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <nav id="primaryNav" aria-label="Primary navigation">
    <a href="index.html">Home</a>
    <a href="timeline.html">Timeline</a>
    <a href="prayers.html">Prayer Wall</a>
    <a href="about.html">About</a>
  </nav>
  <button id="loginBtn">Login</button>
  <button id="logoutBtn" style="display:none;">Logout</button>
</header>

<main>
  <section id="searchBar">
    <input type="search" id="searchInput" placeholder="Search posts, prayers, users..." aria-label="Search posts, prayers, users" />
    <button id="toggleViewBtn" aria-pressed="false">Switch to Prayer Wall</button>
  </section>

  <form id="uploadForm" enctype="multipart/form-data" novalidate>
    <input type="file" id="mediaFile" accept="image/*,video/*" />
    <textarea id="caption" placeholder="Write your caption here..." required minlength="4" maxlength="500"></textarea>
    <button type="submit" disabled>Upload Post</button>
  </form>

  <section id="postContainer" aria-live="polite" aria-relevant="additions"></section>

  <section id="prayerContainer" hidden aria-live="polite" aria-relevant="additions"></section>

  <form class="prayer-form" id="prayerForm" hidden novalidate>
    <textarea id="prayerText" placeholder="Write your prayer request here..." required minlength="4" maxlength="500"></textarea>
    <button type="submit" disabled>Submit Prayer</button>
  </form>
</main>

<script>
const loginBtn = document.getElementById('loginBtn');
const logoutBtn = document.getElementById('logoutBtn');
const menuToggle = document.getElementById('menuToggle');
const primaryNav = document.getElementById('primaryNav');
const toggleViewBtn = document.getElementById('toggleViewBtn');
const postContainer = document.getElementById('postContainer');
const prayerContainer = document.getElementById('prayerContainer');
const uploadForm = document.getElementById('uploadForm');
const prayerForm = document.getElementById('prayerForm');
const searchInput = document.getElementById('searchInput');

// Simulated login
loginBtn.addEventListener('click', () => {
  localStorage.setItem('loggedIn', 'true');
  loginBtn.style.display = 'none';
  logoutBtn.style.display = 'inline-block';
  uploadForm.style.display = 'block';
  prayerForm.hidden = false;
});
logoutBtn.addEventListener('click', () => {
  localStorage.removeItem('loggedIn');
  loginBtn.style.display = 'inline-block';
  logoutBtn.style.display = 'none';
  uploadForm.style.display = 'none';
  prayerForm.hidden = true;
});

// Menu toggle
menuToggle.addEventListener('click', () => {
  primaryNav.classList.toggle('open');
});

// Toggle Timeline/Prayer
let currentView = 'timeline';
toggleViewBtn.addEventListener('click', () => {
  if (currentView === 'timeline') {
    postContainer.hidden = true;
    prayerContainer.hidden = false;
    toggleViewBtn.textContent = 'Switch to Timeline';
    currentView = 'prayer';
  } else {
    prayerContainer.hidden = true;
    postContainer.hidden = false;
    toggleViewBtn.textContent = 'Switch to Prayer Wall';
    currentView = 'timeline';
  }
});

// Enable/disable buttons
document.getElementById('caption').addEventListener('input', e => {
  uploadForm.querySelector('button').disabled = e.target.value.trim().length < 3;
});
document.getElementById('prayerText').addEventListener('input', e => {
  prayerForm.querySelector('button').disabled = e.target.value.trim().length < 3;
});

// Upload post
uploadForm.addEventListener('submit', e => {
  e.preventDefault();
  const file = document.getElementById('mediaFile').files[0];
  const caption = document.getElementById('caption').value.trim();
  const reader = new FileReader();

  reader.onload = () => {
    const url = reader.result;
    const type = file.type.startsWith('video') ? 'video' : 'image';
    const post = {
      id: Date.now(),
      type,
      url,
      caption,
      time: new Date().toLocaleString(),
      comments: [],
      likes: 0,
      boosted: false
    };
    const posts = JSON.parse(localStorage.getItem('posts') || '[]');
    posts.unshift(post);
    localStorage.setItem('posts', JSON.stringify(posts));
    renderPosts();
    uploadForm.reset();
    uploadForm.querySelector('button').disabled = true;
  };

  if (file) reader.readAsDataURL(file);
});

// Submit prayer
prayerForm.addEventListener('submit', e => {
  e.preventDefault();
  const text = document.getElementById('prayerText').value.trim();
  const prayer = {
    id: Date.now(),
    text,
    time: new Date().toLocaleString()
  };
  const prayers = JSON.parse(localStorage.getItem('prayers') || '[]');
  prayers.unshift(prayer);
  localStorage.setItem('prayers', JSON.stringify(prayers));
  renderPrayers();
  prayerForm.reset();
  prayerForm.querySelector('button').disabled = true;
});

// Render timeline
function renderPosts() {
  const posts = JSON.parse(localStorage.getItem('posts') || '[]');
  postContainer.innerHTML = '';
  posts.forEach(post => {
    const div = document.createElement('div');
    div.className = 'post-item';
    div.innerHTML = `
      <div class="post-owner">
        <img src="https://i.pravatar.cc/40?u=${post.id}" class="avatar" />
        <div>
          <div>User</div>
          <div class="post-time">${post.time}</div>
        </div>
      </div>
      <div class="post-caption">${post.caption}</div>
      <div class="post-media">${post.type === 'image' ? `<img src="${post.url}" />` : `<video controls src="${post.url}"></video>`}</div>
      <div class="post-actions">
        <button onclick="likePost(${post.id})">Like (${post.likes})</button>
        <button onclick="boostPost(${post.id})" class="${post.boosted ? 'boosted' : ''}">Boost</button>
      </div>
      <div class="comments-container" id="comments-${post.id}"></div>
      <form class="comment-form" onsubmit="addComment(event, ${post.id})">
        <input type="text" placeholder="Write comment..." required />
        <button type="submit">Comment</button>
      </form>
    `;
    postContainer.appendChild(div);
    renderComments(post.id, post.comments);
  });
}
function renderComments(id, comments) {
  const container = document.getElementById('comments-' + id);
  container.innerHTML = '';
  comments.forEach(c => {
    container.innerHTML += `
      <div class="comment">
        <img src="https://i.pravatar.cc/30?u=${id}" class="avatar" />
        <div class="comment-body">
          <strong>User</strong>${c}
        </div>
      </div>
    `;
  });
}
function likePost(id) {
  const posts = JSON.parse(localStorage.getItem('posts') || '[]');
  const post = posts.find(p => p.id === id);
  post.likes++;
  localStorage.setItem('posts', JSON.stringify(posts));
  renderPosts();
}
function boostPost(id) {
  const posts = JSON.parse(localStorage.getItem('posts') || '[]');
  const post = posts.find(p => p.id === id);
  post.boosted = true;
  localStorage.setItem('posts', JSON.stringify(posts));
  renderPosts();
}
function addComment(e, id) {
  e.preventDefault();
  const input = e.target.querySelector('input');
  const text = input.value.trim();
  if (!text) return;
  const posts = JSON.parse(localStorage.getItem('posts') || '[]');
  const post = posts.find(p => p.id === id);
  post.comments.push(text);
  localStorage.setItem('posts', JSON.stringify(posts));
  renderPosts();
}

// Render prayers
function renderPrayers() {
  const prayers = JSON.parse(localStorage.getItem('prayers') || '[]');
  prayerContainer.innerHTML = '';
  prayers.forEach(p => {
    const div = document.createElement('div');
    div.className = 'prayer-item';
    div.innerHTML = `
      <div class="prayer-owner">
        <img src="https://i.pravatar.cc/40?u=${p.id}" class="avatar" />
        <div>
          <div>User</div>
          <div class="prayer-time">${p.time}</div>
        </div>
      </div>
      <div class="prayer-text">${p.text}</div>
    `;
    prayerContainer.appendChild(div);
  });
}

// Search bar
searchInput.addEventListener('input', e => {
  const q = e.target.value.toLowerCase();
  document.querySelectorAll('.post-item, .prayer-item').forEach(el => {
    el.style.display = el.textContent.toLowerCase().includes(q) ? '' : 'none';
  });
});

// Init
if (localStorage.getItem('loggedIn') === 'true') {
  loginBtn.style.display = 'none';
  logoutBtn.style.display = 'inline-block';
  uploadForm.style.display = 'block';
  prayerForm.hidden = false;
}
renderPosts();
renderPrayers();
</script>

</body>
</html>
