<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DRFMedia Timeline â€” Spread Kindness & Truth</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Existing styles remain -->
</head>
<body>
  <!-- Existing body content remains -->

<script type="module">
  // ... All original imports and Firebase setup remain

  // Modified media rendering with CDN+IPFS fallback for images and videos
  function renderPosts() {
    const filter = searchInput.value.trim().toLowerCase();
    postContainer.innerHTML = "";
    for (const post of allPosts) {
      if (!post.caption.toLowerCase().includes(filter)) continue;

      const gateways = [
        "https://cloudflare-ipfs.com/ipfs/",
        "https://gateway.pinata.cloud/ipfs/",
        "https://ipfs.io/ipfs/"
      ];

      const fallbackLoader = (hash, type) => {
        const sources = gateways.map(url => `${url}${hash}`);
        if (type === "video") {
          return `
            <video controls playsinline preload="metadata" poster="${sources[1]}" loading="lazy">
              ${sources.map(src => `<source src="${src}" type="video/mp4">`).join("\n")}
              Your browser does not support the video tag.
            </video>`;
        } else {
          return `<img src="${sources[0]}" alt="Post media" loading="lazy" onerror="this.onerror=null;this.src='${sources[1]}';">`;
        }
      };

      const mediaHTML = fallbackLoader(post.ipfsHash, post.mediaType);

      // ... The rest of the rendering logic remains unchanged
    }
  }

  // ... The rest of the JS remains unchanged
</script>
</body>
</html>
