<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quran Search with External Data</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f9f9f9;
      color: #111;
      margin: 0;
      padding: 20px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    h1 {
      text-align: center;
      margin-bottom: 1rem;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px 16px;
      font-size: 1.1rem;
      border-radius: 40px;
      border: 1px solid #ccc;
      outline: none;
      box-sizing: border-box;
      margin-bottom: 12px;
      transition: border-color 0.3s ease;
    }
    input[type="text"]:focus {
      border-color: #007bff;
      box-shadow: 0 0 5px rgba(0,123,255,0.5);
    }
    button {
      background-color: #007bff;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 40px;
      cursor: pointer;
      font-size: 1rem;
      margin-bottom: 20px;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #0056b3;
    }
    .ayah-card {
      background: #fff;
      padding: 12px 20px;
      margin: 8px 0;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: background-color 0.3s ease;
      user-select: text;
    }
    .ayah-card p {
      margin: 6px 0;
      line-height: 1.5;
    }
    mark {
      background-color: #ffeb3b;
      color: black;
    }
    .pagination {
      text-align: center;
      margin: 20px 0;
    }
    .pagination button {
      margin: 0 4px;
      padding: 8px 14px;
      font-size: 1rem;
      cursor: pointer;
    }
    .pagination button:disabled {
      background-color: #ccc;
      cursor: default;
    }
    .no-results {
      text-align: center;
      font-style: italic;
      margin-top: 20px;
      color: #666;
    }
  </style>
</head>
<body>
  <h1>Quran Search with External Data</h1>
  <input
    type="text"
    id="searchInput"
    placeholder="Search Surah, Verse number, Arabic or English text..."
  />
  <button id="clearBtn">Clear Search</button>

  <div id="results"></div>
  <div class="pagination" id="pagination"></div>

  <!-- Load your external quranData.js file here -->
  <script src="quranData.js"></script>

  <script>
    const RESULTS_PER_PAGE = 10;
    let currentPage = 1;
    let currentResults = [];

    const input = document.getElementById('searchInput');
    const resultsDiv = document.getElementById('results');
    const paginationDiv = document.getElementById('pagination');
    const clearBtn = document.getElementById('clearBtn');

    clearBtn.addEventListener('click', () => {
      input.value = '';
      resultsDiv.innerHTML = '';
      paginationDiv.innerHTML = '';
      currentResults = [];
      currentPage = 1;
    });

    function escapeRegExp(string) {
      return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    }

    function highlightMatch(text, query) {
      if (!query) return text;
      const escaped = escapeRegExp(query);
      const regex = new RegExp(`(${escaped})`, 'gi');
      return text.replace(regex, '<mark>$1</mark>');
    }

    function renderPage(page) {
      resultsDiv.innerHTML = '';
      paginationDiv.innerHTML = '';

      if (!window.quran || !Array.isArray(quran)) {
        resultsDiv.innerHTML = '<p class="no-results">Quran data not loaded.</p>';
        return;
      }

      if (currentResults.length === 0) {
        resultsDiv.innerHTML = '<p class="no-results">No results found.</p>';
        return;
      }

      const start = (page - 1) * RESULTS_PER_PAGE;
      const end = Math.min(start + RESULTS_PER_PAGE, currentResults.length);
      const pageResults = currentResults.slice(start, end);

      pageResults.forEach(ayah => {
        const div = document.createElement('div');
        div.className = 'ayah-card';

        div.innerHTML = `
          <p><strong>${ayah.surah} - Verse ${ayah.verse}</strong></p>
          <p>${highlightMatch(ayah.arabic, input.value)}</p>
          <p><em>${highlightMatch(ayah.english, input.value)}</em></p>
        `;
        resultsDiv.appendChild(div);
      });

      const totalPages = Math.ceil(currentResults.length / RESULTS_PER_PAGE);
      if (totalPages > 1) {
        for (let i = 1; i <= totalPages; i++) {
          const btn = document.createElement('button');
          btn.textContent = i;
          btn.disabled = i === page;
          btn.addEventListener('click', () => {
            currentPage = i;
            renderPage(currentPage);
            window.scrollTo({ top: 0, behavior: 'smooth' });
          });
          paginationDiv.appendChild(btn);
        }
      }
    }

    function searchQuran() {
      if (!window.quran || !Array.isArray(quran)) {
        resultsDiv.innerHTML = '<p class="no-results">Quran data not loaded.</p>';
        return;
      }
      const query = input.value.trim().toLowerCase();
      if (!query) {
        resultsDiv.innerHTML = '';
        paginationDiv.innerHTML = '';
        currentResults = [];
        return;
      }
      currentResults = quran.filter(ayah => {
        const verseStr = ayah.verse.toString();
        return (
          ayah.surah.toLowerCase().includes(query) ||
          verseStr.includes(query) ||
          ayah.arabic.toLowerCase().includes(query) ||
          ayah.english.toLowerCase().includes(query)
        );
      });
      currentPage = 1;
      renderPage(currentPage);
    }

    input.addEventListener('input', searchQuran);
  </script>
</body>
</html>
