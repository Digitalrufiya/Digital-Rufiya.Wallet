<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8" /><title>Pinata Upload Test</title></head>
<body>
<input type="file" id="fileInput" />
<button id="uploadBtn">Upload to Pinata</button>
<div id="result"></div>

<script>
const pinataJWT = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiI0MjA3ZmYxYS05MDU2LTRkZTktOGE2Yi1lM2JiZTA1YmY0YmEiLCJlbWFpbCI6ImRpZ2l0YWxydWZpeWF1bml2ZXJzaXR5QGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJwaW5fcG9saWN5Ijp7InJlZ2lvbnMiOlt7ImRlc2lyZWRSZXBsaWNhdGlvbkNvdW50IjoxLCJpZCI6IkZSQTEifSx7ImRlc2lyZWRSZXBsaWNhdGlvbkNvdW50IjoxLCJpZCI6Ik5ZQzEifV0sInZlcnNpb24iOjF9LCJtZmFfZW5hYmxlZCI6ZmFsc2UsInN0YXR1cyI6IkFDVElWRSJ9LCJhdXRoZW50aWNhdGlvblR5cGUiOiJzY29wZWRLZXkiLCJzY29wZWRLZXlLZXkiOiIwMDhlNTA2NWJkZGIyZDJiMyIsInNjb3BlZEtleVNlY3JldCI6IjRkN2RiZGU3ZDQxNzllZTIxNmRkMTM3M2JmNjZkNTA1ZGVlZjY3YzNiNGIyMzY3ZWFiNDExZTVjMWFhYzhlNDgiLCJleHAiOjE3ODYyNzQzOTJ9.QqAoU9Lc0StPunmPREujoNnAriNnItbe61xNbrU5sRg";

const fileInput = document.getElementById("fileInput");
const uploadBtn = document.getElementById("uploadBtn");
const result = document.getElementById("result");

uploadBtn.onclick = () => {
  const file = fileInput.files[0];
  if (!file) {
    result.textContent = "Select a file first.";
    return;
  }
  
  const fd = new FormData();
  fd.append("file", file);

  const xhr = new XMLHttpRequest();
  xhr.open("POST", "https://api.pinata.cloud/pinning/pinFileToIPFS");
  xhr.setRequestHeader("Authorization", "Bearer " + pinataJWT);

  xhr.onload = () => {
    if (xhr.status === 200) {
      const resp = JSON.parse(xhr.responseText);
      result.innerHTML = `Upload successful! <br> IPFS Hash: <code>${resp.IpfsHash}</code>`;
    } else {
      result.textContent = `Upload failed: ${xhr.status} ${xhr.statusText}`;
    }
  };

  xhr.onerror = () => {
    result.textContent = "Upload failed: network error";
  };

  xhr.send(fd);
};
</script>
</body>
</html>
