<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pinata + Firebase Upload Example</title>
</head>
<body>
  <h2>Upload file to Pinata and Firebase</h2>
  <input type="file" id="fileInput" />
  <button id="uploadBtn">Upload</button>
  <div id="status"></div>

  <script type="module">
    // Firebase imports and config
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDBxNIIuYonkgF9m8QYdUFDOXIXAM6FYqA",
      authDomain: "drfmarket-place.firebaseapp.com",
      projectId: "drfmarket-place",
      storageBucket: "drfmarket-place.firebasestorage.app",
      messagingSenderId: "752616443115",
      appId: "1:752616443115:web:73b71924daf66ae9c882ae",
      measurementId: "G-MV9JQZHLLY"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

    // Pinata JWT Token
    const pinataJWT = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiI0MjA3ZmYxYS05MDU2LTRkZTktOGE2Yi1lM2JiZTA1YmY0YmEiLCJlbWFpbCI6ImRpZ2l0YWxydWZpeWF1bml2ZXJzaXR5QGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJwaW5fcG9saWN5Ijp7InJlZ2lvbnMiOlt7ImRlc2lyZWRSZXBsaWNhdGlvbkNvdW50IjoxLCJpZCI6IkZSQTEifSx7ImRlc2lyZWRSZXBsaWNhdGlvbkNvdW50IjoxLCJpZCI6Ik5ZQzEifV0sInZlcnNpb24iOjF9LCJtZmFfZW5hYmxlZCI6ZmFsc2UsInN0YXR1cyI6IkFDVElWRSJ9LCJhdXRoZW50aWNhdGlvblR5cGUiOiJzY29wZWRLZXkiLCJzY29wZWRLZXlLZXkiOiIyYjA3YjEyOWJkYTA0YTY2YmE0YSIsInNjb3BlZEtleVNlY3JldCI6IjYxZDdhMGVhYzVmNjAyNzhhNjQyODNlMjdmMTM2YjkxMjQ3YjM4NDg5MjA4YTUzNGYxNWFlMTE2Njc3ZGNkZGQiLCJleHAiOjE3ODYyNzUyNDJ9.BFUeEjlCR0jtpr1vylWYd5VkKVtDkNDhEuC2-3IFW1w";

    const fileInput = document.getElementById('fileInput');
    const uploadBtn = document.getElementById('uploadBtn');
    const statusDiv = document.getElementById('status');

    uploadBtn.addEventListener('click', async () => {
      const file = fileInput.files[0];
      if (!file) {
        statusDiv.textContent = 'Please select a file first.';
        return;
      }

      statusDiv.textContent = 'Uploading to Pinata...';

      try {
        // Prepare form data for Pinata
        const formData = new FormData();
        formData.append('file', file);

        const pinataResponse = await fetch('https://api.pinata.cloud/pinning/pinFileToIPFS', {
          method: 'POST',
          headers: {
            Authorization: `Bearer ${pinataJWT}`
          },
          body: formData
        });

        if (!pinataResponse.ok) {
          throw new Error('Pinata upload failed');
        }

        const pinataData = await pinataResponse.json();

        statusDiv.textContent = `Pinata upload successful! IPFS Hash: ${pinataData.IpfsHash}`;

        // Optionally, you can upload this file also to Firebase Storage or use Firebase features here
        // For this example, just log the firebase app instance
        console.log('Firebase initialized:', app);

      } catch (err) {
        statusDiv.textContent = 'Error uploading file: ' + err.message;
      }
    });
  </script>
</body>
</html>
